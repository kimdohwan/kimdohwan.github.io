<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>[Magic Method] __new__</title>

  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
  <link href='https://fonts.googleapis.com/css?family=Roboto+Condensed:300' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="/style.css">
  <link rel="canonical" href="http://localhost:4000/python/0201/01/01/new.html">
  <link rel="alternate" type="application/rss+xml" title="Your awesome title" href="http://localhost:4000/feed.xml">

  	<!-- 폰트 및 코드 하이라이팅 -->
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/androidstudio.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link href="https://fonts.googleapis.com/css?family=Nanum+Myeongjo&display=swap" rel="stylesheet">
</head>


  <body>

    <div class='wrapper'>

    <!--<input data-function='swipe' id='swipe' type='checkbox'>-->
    <!--<label data-function='swipe' for='swipe' class="btn btn-default" >Menu</label>-->


    <!--<div class='sidebar menu'>-->
    <div id="test">


        <div class="menu">

            <div class="navigation">
                <ul>
                    

                    
                    
                    
                    
                    <li><a href="/">Home</a></li>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </ul>
            </div>


            <hr>

            <div class="navigation">
                <ul>
                    
                    <li>
                        <a href="/categories/Python">Python</a></li>
                    
                    <li>
                        <a href="/categories/Etc">Etc</a></li>
                    
                    <li>
                        <a href="/categories/CodingTest">CodingTest</a></li>
                    
                    <li>
                        <a href="/categories/AWS">AWS</a></li>
                    
                    <li>
                        <a href="/categories/Django">Django</a></li>
                    
                    <li>
                        <a href="/categories/DataStructure">DataStructure</a></li>
                    
                </ul>
            </div>

            <hr>

            <!--<div id="picture" style="background-image: url(http://www.naturaloil.ph/wp-content/uploads/2015/11/John_Doe.jpg)"></div>-->
            <p>One sentence introducing yourself or what you do</p>

            <hr>


            <div id="social-icons">
                <ul>
                    <!--<li><a href="http://facebook.com/username"><i class="fa fa-facebook"></i></a></li>-->
                    <!--<li><a href="https://mx.linkedin.com/in/username"><i class="fa fa-linkedin"></i></a></li>-->
                    <li><a href="http://github.com/username"><i class="fa fa-github"></i></a></li>
                    <!--<li><a href="http://username.deviantart.com"><i class="fa fa-deviantart"></i></a></li>-->
                    <!--<li><a href="http://codepen.io/username"><i class="fa fa-codepen"></i></a></li>-->
                </ul>
            </div>

            <hr>

            <!--<p>© Taken theme<p>-->
            <!--<p>Powered by Jekyll<p>-->

        </div>
    </div>

    <div class='content'>
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
     <h2 class="post-title">[Magic Method] __new__</h2>
     <p class="post-meta"><time datetime="0201-01-01T00:01:44+08:27" itemprop="datePublished">Jan 1, 0201</time></p>
      <hr>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h3 id="테스트-클래스-작성">테스트 클래스 작성</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class TestClass:
    '''
    이것은 docstring 입니다
    '''
    def __init__(self, name):
        self.name = name

    def method_function(self):
        '''
        함수안의 docstring
        '''
        print('this is method function')

    def __call__(self, x, y):
        return x + y

    def __getattr__(self, attribute):
        return f'{attribute} 는 없다 이놈아'


def common_function():
    print('this is common function')

a = TestClass('안녕')
b = common_function
</code></pre></div></div>

<h3 id="__new__"><code class="highlighter-rouge">__new__</code></h3>

<blockquote>
  <p>instance 를 만들 때 new 는 init 에 앞서 객체생성을 할당하고<br />
new 가 init 을 호출해서 사용할 초기값들을 initialize 하게 된다.</p>
</blockquote>

<p>Foo() -&gt; <code class="highlighter-rouge">__new__(allocator)</code> -&gt; <code class="highlighter-rouge">__init__(initializer)</code></p>

<blockquote>
  <p>Use <code class="highlighter-rouge">__new__</code> when you need to control the creation of a new instance.<br />
Use <code class="highlighter-rouge">__init__</code> when you need to control initialization of a new instance.</p>
</blockquote>

<p>또한 new 의 경우 새 인스턴스를 return 하지만<br />
init 의 경우 return 이 없고(return 아예 불가능) new 가 만들어준 instance 에<br />
parameter 로 self 를 받아 initializing 한다</p>

<p>new 는 cls 를 parameter 로 받으며<br />
new 가 호출 되었을 때, 아직 init 을 위한 self 가 존재하지 않는다<br />
(enable to use ‘self’ after <code class="highlighter-rouge">__new__</code>)</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code># new 를 사용해서 클래스 creation 만 해봄
# 이 때 init 에 필요한 name 이 없음에도 불구하고 클래스 생성 됨
new_a = TestClass.__new__(TestClass)
# new_b = TestClass() &lt;- name 안넣었다고 init 이 안됨
print(
    type(new_a), '\n',
    new_a.method_function(), '\n', # instance method 잘 동작
    new_a.name, '\n', # name 존재하지 않음 
    type(new_a) == type(a), '\n', # 같은 클래스 맞다 
    isinstance(new_a, TestClass), # instance 맞다
)

'''결과값
this is method function
&lt;class '__main__.TestClass'&gt; 
 None 
 name 는 없다 이놈아 
 True 
 True'''

</code></pre></div></div>

<h3 id="new-를-overriding-하는-경우">new 를 overriding 하는 경우</h3>

<blockquote>
  <p>In general, you shouldn’t need to override <strong>new</strong><br />
unless you’re subclassing an immutable type like str, int, unicode or tuple.</p>
</blockquote>

<p>불변 타입을 서브클래스화 하지 않는다면 new 를 override 할 필요없다는데<br />
무슨소리인지 잘 모르겠다 ㅎㅎㅎ<br />
일단 밑에 보이는 정도로 이해하고 넘어가자</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>class A:
    def __new__(cls):
        print("A.__new__ called")
        return super(A, cls).__new__(cls)

    def __init__(self):
        print("A.__init__ called")


# __new__ return 에서 super(상속)를 없애면
# init 을 호출하지 않기때문에 객체생성만 하고 initialize 과정이 없게된다
class B:
    def __new__(cls):
        print("B.__new__ called")
#         return super(B, cls).__new__(cls)

    def __init__(self):
        print("B.__init__ called")

'''결과값        
A()
B() # init 실행되지 않음
A.__new__ called
A.__init__ called
B.__new__ called'''

</code></pre></div></div>

  </div>

  <!-- To enable Disqus comments, comment out this code and insert your Disqus shortname -->

  <!--  -->

</article>

    </div>
</div>

      
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-2.x-git.min.js"></script>
      
    <!-- Bootstrap Core JavaScript -->
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

    <script src="/js/index.js"></script>

  </body>

    <script>
    $("#menu-toggle").click(function(e) {
        e.preventDefault();
        $("#wrapper").toggleClass("toggled");
    });
    </script>

    <script>
    $(document).ready(function(){
    $('#page-content-wrapper').fadeIn();
    });
    </script>

</html>
